<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Админ-панель | Заказы</title>
  <script src="local-data.js"></script>
  <script src="api-client.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="admin-styles.css">
</head>
<body>
  <!-- Боковое меню -->
  <div class="sidebar">
    <div class="sidebar-header">
      <h2>Damax</h2>
      <p>Админ-панель</p>
    </div>
    <nav class="nav-menu">
      <div class="nav-item">
        <a href="admin-dashboard.html" class="nav-link">
          <i class="fas fa-tachometer-alt"></i>
          Дашборд
        </a>
      </div>
      <div class="nav-item">
        <a href="admin-panel.html" class="nav-link">
          <i class="fas fa-box"></i>
          Товары
        </a>
      </div>
      <div class="nav-item">
        <a href="admin-orders.html" class="nav-link active">
          <i class="fas fa-shopping-cart"></i>
          Заказы
        </a>
      </div>
      <div class="nav-item">
        <a href="admin-settings.html" class="nav-link">
          <i class="fas fa-cog"></i>
          Настройки
        </a>
      </div>
    </nav>
  </div>

  <!-- Основной контент -->
  <div class="main-content">
    <div class="page-header">
      <h1 class="page-title">
        <i class="fas fa-shopping-cart"></i>
        Управление заказами
      </h1>
      <p class="page-subtitle">Просмотр и управление всеми заказами клиентов</p>
    </div>

    <!-- Статистика заказов -->
    <div class="stats-grid">
      <div class="stat-card new">
        <div class="stat-number" id="newOrdersCount">0</div>
        <div class="stat-label">Новые заказы</div>
      </div>
      <div class="stat-card processing">
        <div class="stat-number" id="processingOrdersCount">0</div>
        <div class="stat-label">В обработке</div>
      </div>
      <div class="stat-card completed">
        <div class="stat-number" id="completedOrdersCount">0</div>
        <div class="stat-label">Выполненные</div>
      </div>
      <div class="stat-card cancelled">
        <div class="stat-number" id="cancelledOrdersCount">0</div>
        <div class="stat-label">Отмененные</div>
      </div>
    </div>

    <!-- Таблица заказов -->
    <div class="orders-section">
      <div class="section-header">
        <h2 class="section-title">Список заказов</h2>
        <div class="section-actions">
          <button class="btn btn-outline btn-sm" id="refreshOrders">
            <i class="fas fa-sync-alt"></i>
            Обновить
          </button>
          <button class="btn btn-primary btn-sm" id="exportOrders">
            <i class="fas fa-download"></i>
            Экспорт
          </button>
        </div>
      </div>
      
      <div class="table-container">
        <table class="orders-table">
          <thead>
            <tr>
              <th>№ Заказа</th>
              <th>Клиент</th>
              <th>Товары</th>
              <th>Сумма</th>
              <th>Статус</th>
              <th>Дата</th>
              <th>Действия</th>
            </tr>
          </thead>
          <tbody id="ordersTableBody">
            <!-- Заказы будут загружены через JavaScript -->
          </tbody>
        </table>
      </div>
      
      <!-- Пустое состояние -->
      <div class="empty-state" id="emptyState" style="display: none;">
        <i class="fas fa-shopping-cart"></i>
        <h3>Заказов пока нет</h3>
        <p>Когда появятся новые заказы, они отобразятся здесь</p>
      </div>
    </div>
  </div>

  <script>
    // Данные для демонстрации
    const mockOrders = [
      {
        id: 'ORD-001',
        customer: 'Иван Петров',
        email: 'ivan@example.com',
        items: [
          { name: 'Смартфон Samsung Galaxy', quantity: 1, price: 25000 }
        ],
        total: 25000,
        status: 'new',
        date: '2024-01-15T10:30:00',
        phone: '+7 (999) 123-45-67'
      },
      {
        id: 'ORD-002',
        customer: 'Мария Сидорова',
        email: 'maria@example.com',
        items: [
          { name: 'Ноутбук Dell Inspiron', quantity: 1, price: 45000 },
          { name: 'Мышь беспроводная', quantity: 1, price: 1500 }
        ],
        total: 46500,
        status: 'processing',
        date: '2024-01-14T15:45:00',
        phone: '+7 (999) 234-56-78'
      },
      {
        id: 'ORD-003',
        customer: 'Алексей Козлов',
        email: 'alex@example.com',
        items: [
          { name: 'Наушники Sony WH-1000XM4', quantity: 1, price: 18000 }
        ],
        total: 18000,
        status: 'completed',
        date: '2024-01-13T09:15:00',
        phone: '+7 (999) 345-67-89'
      },
      {
        id: 'ORD-004',
        customer: 'Елена Воробьева',
        email: 'elena@example.com',
        items: [
          { name: 'Планшет iPad Air', quantity: 1, price: 35000 }
        ],
        total: 35000,
        status: 'cancelled',
        date: '2024-01-12T14:20:00',
        phone: '+7 (999) 456-78-90'
      }
    ];

    // Функции для работы с заказами
    function updateStats() {
      const stats = {
        new: mockOrders.filter(order => order.status === 'new').length,
        processing: mockOrders.filter(order => order.status === 'processing').length,
        completed: mockOrders.filter(order => order.status === 'completed').length,
        cancelled: mockOrders.filter(order => order.status === 'cancelled').length
      };

      document.getElementById('newOrdersCount').textContent = stats.new;
      document.getElementById('processingOrdersCount').textContent = stats.processing;
      document.getElementById('completedOrdersCount').textContent = stats.completed;
      document.getElementById('cancelledOrdersCount').textContent = stats.cancelled;
    }

    function getStatusText(status) {
      const statusMap = {
        new: 'Новый',
        processing: 'В обработке',
        completed: 'Выполнен',
        cancelled: 'Отменен'
      };
      return statusMap[status] || status;
    }

    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('ru-RU', {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });
    }

    function formatPrice(price) {
      return new Intl.NumberFormat('ru-RU', {
        style: 'currency',
        currency: 'RUB'
      }).format(price);
    }

    function renderOrders() {
      const tbody = document.getElementById('ordersTableBody');
      const emptyState = document.getElementById('emptyState');

      if (mockOrders.length === 0) {
        tbody.innerHTML = '';
        emptyState.style.display = 'block';
        return;
      }

      emptyState.style.display = 'none';
      
      tbody.innerHTML = mockOrders.map(order => `
        <tr>
          <td class="order-id">${order.id}</td>
          <td>
            <div>
              <strong>${order.customer}</strong><br>
              <small>${order.email}</small><br>
              <small>${order.phone}</small>
            </div>
          </td>
          <td>
            ${order.items.map(item => 
              `${item.name} × ${item.quantity}`
            ).join('<br>')}
          </td>
          <td><strong>${formatPrice(order.total)}</strong></td>
          <td>
            <span class="order-status status-${order.status}">
              ${getStatusText(order.status)}
            </span>
          </td>
          <td>${formatDate(order.date)}</td>
          <td>
            <div class="order-actions">
              <button class="btn-icon view" title="Просмотр" onclick="viewOrder('${order.id}')">
                <i class="fas fa-eye"></i>
              </button>
              <button class="btn-icon edit" title="Редактировать" onclick="editOrder('${order.id}')">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn-icon delete" title="Удалить" onclick="deleteOrder('${order.id}')">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      `).join('');
    }

    function viewOrder(orderId) {
      const order = mockOrders.find(o => o.id === orderId);
      if (order) {
        alert(`Просмотр заказа ${orderId}\nКлиент: ${order.customer}\nСумма: ${formatPrice(order.total)}`);
      }
    }

    function editOrder(orderId) {
      const order = mockOrders.find(o => o.id === orderId);
      if (order) {
        alert(`Редактирование заказа ${orderId}`);
      }
    }

    function deleteOrder(orderId) {
      if (confirm(`Вы уверены, что хотите удалить заказ ${orderId}?`)) {
        const index = mockOrders.findIndex(o => o.id === orderId);
        if (index !== -1) {
          mockOrders.splice(index, 1);
          updateStats();
          renderOrders();
        }
      }
    }

    function refreshOrders() {
      // Здесь будет загрузка заказов с сервера
      console.log('Обновление заказов...');
      updateStats();
      renderOrders();
    }

    function exportOrders() {
      // Здесь будет экспорт заказов
      alert('Экспорт заказов в разработке');
    }

    // Инициализация
    document.addEventListener('DOMContentLoaded', function() {
      updateStats();
      renderOrders();

      // Обработчики событий
      document.getElementById('refreshOrders').addEventListener('click', refreshOrders);
      document.getElementById('exportOrders').addEventListener('click', exportOrders);
    });
  </script>

</body>
</html>